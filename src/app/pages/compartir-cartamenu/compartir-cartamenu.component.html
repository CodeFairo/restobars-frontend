<h2>Compartir Carta del Menú</h2>

<mat-form-field appearance="fill" class="full-width">
  <mat-label>Selecciona un restaurante</mat-label>
  <mat-select [(value)]="selectedRestobarId" (selectionChange)="onRestobarSelected()">
    <mat-option *ngFor="let restobar of restobares" [value]="restobar.id">
      {{ restobar.name }}
    </mat-option>
  </mat-select>
</mat-form-field>

<div *ngIf="loading">Cargando menú...</div>

<div *ngIf="urlMenu && !loading">
  <h3>Vista previa del menú</h3>
  <ng-container *ngIf="urlMenu.endsWith('.pdf'); else imagePreview">
    <iframe [src]="urlMenu | safeUrl" width="100%" height="500px"></iframe>
  </ng-container>
  <ng-template #imagePreview>
    <img [src]="urlMenu" alt="Menú" width="100%" style="max-width: 600px;" />
  </ng-template>

  <h3>Compartir enlace</h3>
  <input type="text" [value]="urlMenu" readonly class="form-control" />
  <button mat-raised-button color="primary" (click)="copyLink()">Copiar enlace</button>

  <h3>Generar y compartir QR</h3>
  <div id="qr-code">
    <!--<qr-code [value]="urlMenu" size="200" errorCorrectionLevel="M"></qr-code>-->
  </div>
  <button mat-button (click)="downloadQR()">Descargar QR</button>
</div>

<div *ngIf="!urlMenu && selectedRestobarId && !loading">
  <p>No se ha subido un menú para este restaurante.</p>
</div>
